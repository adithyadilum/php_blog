# Protect hidden files like .env

<FilesMatch "^\.">
Require all denied
</FilesMatch>

<IfModule !mod_authz_core.c>
<FilesMatch "^\.">
Order allow,deny
Deny from all
</FilesMatch>
</IfModule>

# ---------------------------------------------------------------------

# Force HTTPS for all requests

# ---------------------------------------------------------------------

RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ---------------------------------------------------------------------

# Security Headers

# ---------------------------------------------------------------------

# Enforce HTTPS in browsers

Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

# Prevent embedding your site in iframes (anti clickjacking)

Header always set X-Frame-Options "SAMEORIGIN"

# Prevent basic XSS attacks

Header always set X-XSS-Protection "1; mode=block"

# Prevent content sniffing

Header always set X-Content-Type-Options "nosniff"

# Ensure index.php handles directory requests

DirectoryIndex index.php
